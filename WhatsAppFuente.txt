const {
    default: makeWASocket,
    DisconnectReason,
    useMultiFileAuthState
} = require('@adiwajshing/baileys');
const P = require('pino');
async function run() {
    console.log('starting')
    const { state, saveCreds } = await useMultiFileAuthState("baileys_auth_info");
    const sock = await makeWASocket({
        printQRInTerminal: true,
        logger: P({level: 'silent'}),
        auth: state
    });
    sock.ev.on('connection.update', update => {
        const { connection, lastDisconnect} = update;
        if(connection === 'close') {
            if(lastDisconnect.error.hasOwnProperty('output') ? lastDisconnect.error.output.statusCode !== DisconnectReason.loggedOut : true) {
                console.log("Connection error, reconnecting...");
                run();
            } else if(lastDisconnect.error.output.statusCode === DisconnectReason.loggedOut) {
                console.log("Desconnected, reconnecting tryed...");
                run();
            };
        } else if(connection === 'open') {
                console.log("Connected succesfully to WhatsApp.");
        };
    });
sock.ev.on('creds.update', saveCreds);
const chatIds = [
"5356232334-1633898220@g.us",

"120363028962379574@g.us"
];
    setInterval(async () => {
        // Creamos un bucle para enviar mensajes a cada grupo en el intervalo de 1 minuto
        for (const chatId of chatIds) {
const message = {
          text: '⭕  ❌  ⭕  ❌  ⭕  ❌  ⭕  ❌  ⭕        *BUSCO* \n  *MLC 170*\n *USD 175*\n *EURO 180*\n *CANADIENSE 115*\n          Envios de Remesa x Zelle al 10%\n *100zelle x 16 800 cup cuba*\n 120zelle  x 110mlc. Cuban\n 115zelle  x 105mlc.  Cuba\n *110zelle  x 100mlc Cuba*\n        LA Mejor Oferta \n *TRATO PRESENCIAL*  ⚪ ♌ ♋ ♊ ♈ ♣♥♀⛎ ♑  '
};
            const options = {};
            await sock.sendMessage(chatId, message, options);
            console.log(`Mensaje enviado a ${chatId}`);
            // Esperamos 1 minuto antes de enviar el siguiente mensaje
            await new Promise(resolve => setTimeout(resolve, 60000));
        }
    }, 10800000);
}
run();